extends layouts
block content
    link(rel="stylesheet" href="/css/movie-details.css")
    div.container
        div.d-flex.justify-content-center
                h2.my-2 #{movie.title}
        div.containerGrid(style="border: 3px solid black; border-radius: 20px;  background-color: #383434; background-clip: padding-box;")
            div.col1(style="padding: 10px;")
                div.row.innerGrid
                    div.col3.d-flex.justify-content-center(style="align-self: start;")
                        img(src= config.images.base_url + config.images.backdrop_sizes[0] + movie.poster_path, style="width: 100%; height: 100%; border-radius: 20px;")
                    div.col4
                        div#rating.progress.my-2(style="background-color: black;")
                        h5 Genres:
                        div#genres.d-flex.flex-wrap.my-2(style="gap: 10px;")
                        h6 Keyword:
                        div#keywords.d-flex.flex-wrap.my-2(style="gap: 10px;")
                hr
                div.row
                    h4 Overwiew
                    h6#tagline(style="font-style: italic;") &ldquo;#{movie.tagline}&ldquo;
                    p #{movie.overview}
            div#trailer.col2.ratio.ratio-16x9(style="background-color: black; border-radius: 20px;")
                iframe#trailer-iframe(src="https://www.youtube.com/embed/" + trailerKey, style="border-radius: 20px;", allowfullscreen)
        
        div
            h3.my-4 Production Companies
            div#productionCompanies.flex-wrap
            h3.my-4 Production Countries
            div#productionCountries.flex-wrap
        
    script.
        let M = !{JSON.stringify(movie)};
        let K = !{JSON.stringify(keywords)};//Array di oggetti keyword (id, name)
        let config = !{JSON.stringify(config)};

        if(M.tagline==""){
            $("#tagline").hide();
        }

        for(let i = 0; i < M.genres.length; i++) {
            $('#genres').append(`<div class="p-2 badge rounded-pill text-bg-secondary" style="font-size: 13px;">${M.genres[i].name}</div>`);
         }

        for(let i = 0; i < K.length; i++) {
            $('#keywords').append(`<div>#${K[i].name}</div>`);
         }

        for(let i = 0; i < M.production_companies.length; i++) {
            if(M.production_companies[i].logo_path != null){
                $('#productionCompanies').append(`<img src="${config.images.base_url + config.images.logo_sizes[1] + M.production_companies[i].logo_path}" style="border-radius: 10px; margin: 10px;">`);
            } else {
                $('#productionCompanies').append(`<div class="p-2 badge rounded-pill text-bg-secondary mx-1" style="font-size: 13px;">${M.production_companies[i].name}</div>`);
            }
         }

        for(let i = 0; i < M.production_countries.length; i++) {
            $('#productionCountries').append(`<div class="p-2 badge rounded-pill text-bg-secondary mx-1" style="font-size: 13px;">${M.production_countries[i].name}</div>`);
         }

        $('#rating').append(`<div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: ${M.vote_average * 10}%;" aria-valuenow="${M.vote_average * 10}" aria-valuemin="0" aria-valuemax="100">Rating: ${M.vote_average}</div>`);
        if(M.vote_average < 3.3){
            $('#rating').children().addClass('bg-danger');
        }else if(M.vote_average < 6.6){
            $('#rating').children().addClass('bg-info');
        }else{
            $('#rating').children().addClass('bg-success');
        }